import vendor/etc/init/android.hardware.biometrics.fingerprint@2.1-service.rc
service vendor.factorytest /vendor/bin/factorytest
    user root
    group root input radio system sdcard_rw net_bt_admin wifi camera media

service console-ft /system/bin/sh
    console
    user root
    group root
    seclabel u:r:shell:s0

on property:ro.bootmode=factorytest
    class_start early_hal
    class_start hal
    start sensors-hal-1-0
    start vendor.sensors-hal-1-0
    setprop persist.ylog.enabled 1
    start ylog
    start slogmodem
    start hwservicemanager
    start console-ft
    start debuggerd
    start debuggerd64
    start modem_control
    start logd
    start gnss_download
    start audioserver
    start media
    start wcnd
    start wcnd_eng
    start gpsd
    start servicemanager
    start wificond
    start vendor.factorytest

#support for android8.1 trigger by bootmode=factorytest in init.rc
on factorytest
    class_start early_hal
    class_start hal
    start sensors-hal-1-0
    start vendor.sensors-hal-1-0
    setprop persist.ylog.enabled 1
    start ylog
    start slogmodem
    start hwservicemanager
    start console-ft
    start debuggerd
    start debuggerd64
    start vendor.modem_control
    start logd
    start gnss_download
    start audioserver
    start media
    start wcnd
    start wcnd_eng
    start gpsd
    start servicemanager
    start wificond
    chmod 0666 /dev/blfp
    chown system system /dev/blfp
    chmod 0660 /dev/trusty-ipc-dev0
    chown system system /dev/trusty-ipc-dev0
    chmod 0666 /dev/adf-interface0.0
    chmod 0666 /dev/adf-overlay-engine0.0
    chmod 0666 /dev/adf0
    chmod  0666  /sys/class/compass/msensor/enable_device
    chmod  0666  /sys/class/compass/msensor/pollrate_ms    
    chmod 0666 /dev/snd/controlC0
    chmod 0666 /dev/snd/controlC1
    chmod 0666 /dev/snd/controlC2
    chmod 0666 /dev/snd/controlC3
    chmod 0666 /dev/snd/pcmC0D0c
    chmod 0666 /dev/snd/pcmC0D0p
    chmod 0666 /dev/snd/pcmC0D1c
    chmod 0666 /dev/snd/pcmC0D1p
    chmod 0666 /dev/snd/pcmC0D2c
    chmod 0666 /dev/snd/pcmC0D3c
    chmod 0666 /dev/snd/pcmC0D4p
    chmod 0666 /dev/snd/pcmC0D5p
    chmod 0666 /dev/snd/pcmC1D0c
    chmod 0666 /dev/snd/pcmC1D0p
    chmod 0666 /dev/snd/pcmC2D0c
    chmod 0666 /dev/snd/pcmC2D0p
    chmod 0666 /dev/snd/pcmC2D1p
    chmod 0666 /dev/snd/pcmC3D0c
    chmod 0666 /dev/snd/pcmC3D0p
    chmod 0666 /dev/snd/pcmC3D1p
    start btlfpserver
    start vendor.factorytest
